---
title: "Windowsã®uvã§CUDA 12.4ã®PyTorchã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["python", "uv", "pytorch"]
published: true
---

ã‚ã‘ã‚ã£ã¦Windowsã§PyTorchã®ç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã›ã£ã‹ããªã®ã§[uv](https://github.com/astral-sh/uv)ã§ç®¡ç†ã—ãŸã„ã¨æ€ã„ç«‹ã¡ã¾ã—ãŸã€‚  
ãŸã ã€[å…¬å¼ã‚µã‚¤ãƒˆ](https://pytorch.org/get-started/locally)ã®Windowsæ¬„ã«ã‚ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’uvç”¨ã«å¤‰æ›´ã—ã¦å®Ÿè¡Œã—ã¦ã¿ã‚‹ã‚‚â€¦

```sh
uv add torch torchvision --index-url https://download.pytorch.org/whl/cu124
```

```txt
error: Distribution `torch==2.5.0 @ registry+https://download.pytorch.org/whl/cu124` can't be installed because it doesn't have a source distribution or wheel for the current platform
```

ãªã‚“ã‹æ€’ã‚‰ã‚Œã¡ã‚ƒã„ã¾ã—ãŸğŸ˜¢  
ä¸€å¿œ

```sh
uv pip install torch torchvision --index-url https://download.pytorch.org/whl/cu124
```

ã¨ã™ã‚‹ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã‚“ã§ã™ãŒã€ã›ã£ã‹ãã®uvã®ãƒ¡ãƒªãƒƒãƒˆãŒãªããªã£ã¦ã—ã¾ã†ã®ã§ã©ã†ã«ã‹uvã§ç®¡ç†ã§ããªã„ã‹ã¨èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚  
ã™ã‚‹ã¨ä¸€æ—¥å‰ã«æŠ•ç¨¿ã•ã‚Œã¦ãŸã€ã“ã®è¨˜äº‹ãŒã‚ã¡ã‚ƒãã¡ã‚ƒå‚è€ƒã«ãªã‚Šã¾ã—ãŸï¼
ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™(._.)

https://zenn.dev/mjun0812/articles/b32f870bb3cdbf

ä¸Šè¨˜ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ã€æœ€çµ‚çš„ã«å®Œæˆã—ãŸ `pyproject.toml` ãŒã“ã‚Œã§ã™ã€‚  
è¨˜äº‹ã¨ã¯é•ã„ç´ ç›´ã«CUDAç‰ˆã®PyTorchã‚’å…¥ã‚Œã¦ãã‚‹ã ã‘ã§ã™ã€‚  

```toml
[project]
name = "uv-cuda-test"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.12"
dependencies = [
    "torch==2.5.0+cu124",
    "torchvision==0.20.0+cu124",
]

[tool.uv.sources]
torch = { index = "torch-cuda" }
torchvision = { index = "torch-cuda" }

[[tool.uv.index]]
name = "torch-cuda"
url = "https://download.pytorch.org/whl/cu124"
explicit = true
```

ã“ã‚Œã‚’æ‰‹å‹•ã§è¨˜å…¥ã—ãŸã‚ã¨ã€`uv sync` ã—ã¦ã€ `uv run hello.py` ã™ã‚‹ã¨ç„¡äº‹å‹•ãã¾ã—ãŸï¼  
