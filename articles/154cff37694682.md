---
title: "Hugging Faceã§è‡ªä½œç”»åƒãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å…¬é–‹ã™ã‚‹"
emoji: "ğŸ¤—"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["huggingface", "dataset"]
published: true
---

## Hugging Face CLIã§loginã™ã‚‹

å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚  

```sh
pip install huggingface_hub datasets pillow tqdm
```

ãã®å¾Œ

```sh
huggingface-cli login
```

ã¨ã™ã‚‹ã¨ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¥åŠ›ã™ã‚‹ç”»é¢ã«ãªã‚‹ã®ã§ã€<https://huggingface.co/settings/tokens> ã‹ã‚‰ **Write** ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã—ã¦å…¥åŠ›ã—ã¾ã™ã€‚  
å…¥åŠ›å¾Œã€ `Login successful` ã¨è¡¨ç¤ºã•ã‚Œã‚Œã°OKã§ã™ã€‚  

## ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä½œæˆ

Hugging Faceã§ã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã« `train` ã‚„ `test` ãªã©ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚ã‚‹ã¨è‡ªå‹•ã§ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åˆ†ã‘ã¦ãã‚Œã¾ã™ã€‚  
ä»–ã«ã‚‚ã„ãã¤ã‹ãƒªãƒã‚¸ãƒˆãƒªã®åˆ†å‰²æ–¹æ³•ãŒã‚ã‚‹ã®ã§è©³ã—ãã¯[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://huggingface.co/docs/datasets/en/repository_structure#split-pattern-hierarchy)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚  

ä»Šå›ã¯trainãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ã¿ä½œæˆã™ã‚‹ã“ã¨ã«ã™ã‚‹ã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã«ãªã‚Šã¾ã™ã€‚  
ã¾ãŸtrainä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã¯ ãã®ä¸‹ã«ã‚ã‚‹ç”»åƒã®labelåã«ãªã‚Šã¾ã™ã€‚  

```txt
.
â””â”€â”€ data
    â””â”€â”€ train
        â””â”€â”€ monkey
            â”œâ”€â”€ 001.png
            |   ï¸™
            â””â”€â”€ 100.png
```

ãã—ã¦ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§Datasetã‚’ä½œæˆã—ã¾ã™ã€‚  

```py
import os

from datasets import Dataset
from tqdm import tqdm
from PIL import Image

REPO_OWNER = "" # Hugging Faceã§ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›ã™ã‚‹
REPO_NAME = "" # ä½œæˆã—ãŸã„ãƒªãƒã‚¸ãƒˆãƒªåã‚’å…¥ã‚Œã‚‹
DATA_DIR_PATH = r"" # ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ã‚¹ã‚’å…¥åŠ›ã™ã‚‹
FILE_EXTENSION = "" # ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å«ã‚ã‚‹ç”»åƒã®æ‹¡å¼µå­ã‚’æŒ‡å®šã™ã‚‹

records = []
for dir_name in os.listdir(DATA_DIR_PATH):
    dir_path = os.path.join(DATA_DIR_PATH, dir_name)
    if os.path.isdir(dir_path):
        for file_name in tqdm(os.listdir(dir_path)):
            if file_name.endswith(FILE_EXTENSION):
                file_path = os.path.join(dir_path, file_name)
                with Image.open(file_path) as im:
                    records.append({
                        "image": im,
                        "label": dir_name
                    })

dataset = Dataset.from_dict({"image": [r["image"] for r in records], "label": [r["label"] for r in records]})
dataset.push_to_hub(f"{REPO_OWNER}/{REPO_NAME}")
```

ãªãŠã€å®Ÿéš›ã«ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒã“ã¡ã‚‰ã§ã™ã€‚  
ImageNetã®monkeyã ã‘ã‚’æŠ½å‡ºã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ãªã‚Šã¾ã™ã€‚  

https://huggingface.co/datasets/yashikota/imagenet-monkey

## å‚è€ƒ

https://huggingface.co/docs/datasets/en/image_dataset
