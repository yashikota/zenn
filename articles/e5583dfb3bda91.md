---
title: "WezTermã®ã‚¿ãƒ–ã«OSC 2ã§git rootåã‚’è¡¨ç¤ºã™ã‚‹"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["wezterm"]
published: true
---

WezTermã®ã‚¿ãƒ–ã«ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¡¨ç¤ºã—ãŸã‹ã£ãŸã®ã§ã™ãŒå˜ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã ã¨å«Œã ã£ãŸã®ã§ã€Gitã§ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãªã‚‰Gitã®rootåã‚’ã€ãã†ã§ãªã‘ã‚Œã°ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚  

![wezterm + osc2](/images/wezterm-osc2/image.png)

[OSC2](https://wezterm.org/recipes/passing-data.html?h=osc#osc-0-1-2-for-setting-the-windowpane-title)ã¨ã„ã†ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã‚»ãƒƒãƒˆã™ã‚‹ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒã‚ã‚‹ã¿ãŸã„ãªã®ã§ã“ã‚Œä½¿ã„ã¾ã—ãŸã€‚  
ã“ã‚“ãªæ„Ÿã˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚  

```lua
# ã‚¿ãƒ–ã«git rootåã‚’è¨­å®š
function __osc2_title() {
    local git_root=$(git rev-parse --show-toplevel 2>/dev/null)
    local title=${${git_root:t}:-${PWD:t}}
    printf '\033]2;%s\033\\' "$title"
}
chpwd_functions+=(__osc2_title)
__osc2_title  # åˆå›å®Ÿè¡Œ
```

```lua
local wezterm = require("wezterm")

local M = {}

function M.setup()
    wezterm.on("format-tab-title", function(tab)
        local title = tab.active_pane.title
        if title == "" then title = "-" end

        return {
            { Text = " " .. title .. " " },
        }
    end)
end

return M
```
